!function(){if("petharbor.com"!=document.location.host)return window.open("https://petharbor.com/WelcomeFrameContent.htm","_blank"),!1;document.open();var e=new XMLHttpRequest,t=prompt("*** ONLY WORKS FROM the petharbor.com domain ***\n\nSearch for dog name or A# (leave blank to search for all dogs):");t=null==t?"":t.trim();var a=/A[0-9]{7}/i.test(t),o=1,n=document.location.protocol+"//petharbor.com/results.asp?searchtype=ALL&start=3&nopod=1&grid=1&friends=1&samaritans=1&nosuccess=0&orderby=Located%20At&rows=100&imght=120&imgres=Detail&tWidth=350&view=sysadm.v_mrcp_lost&nobreedreq=1&nomax=1&nocustom=1&fontface=Arial&fontsize=10&miles=20&shelterlist=%27MRCP%27,%27MRCP2%27&atype=&where=type_DOG&PAGE=";e.open("GET",n+o,!0),e.send(null),document.write("Retrieving results ");var r=0,s=[];e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status){if(e.responseText){var l,i=(new DOMParser).parseFromString(e.responseText,"text/html");if(totalRowsStr=i.querySelector("#frmResults").querySelector("center").textContent,totalRows=totalRowsStr.split(" ")[2],[].forEach.call(i.getElementsByClassName("gridResult"),(function(e){if(imgStr=e.getElementsByTagName("img")[0].outerHTML,imgStr=imgStr.slice(0,4)+" style='max-width:350'"+imgStr.slice(4),gtElems=e.getElementsByClassName("gridText"),0!=gtElems[1].getElementsByTagName("span").length){intakeDate=gtElems[2].textContent,intakeDateFmt=new Date(intakeDate),dogDetails=gtElems[1].innerHTML,dogNameAry=dogDetails.match(/My name is ([^.]+)\./),l="",dogNameAry&&(l=dogNameAry[1]);let e=gtElems[0].textContent;(""===t||!a&&dogDetails.includes("My name is "+t.toUpperCase())||a&&t.toLowerCase()==e.toLowerCase())&&(s[r]={name:l,details:dogDetails,animalId:e,intakeDate:intakeDate,img:imgStr,location:gtElems[4].textContent},r++)}})),totalRows>100*o)document.write("."),o++,e.open("GET",n+o,!0),e.send(null);else{s.sort(((e,t)=>e.intakeDate-t.intakeDate)),document.open();var m="<table border='1' style='border-collapse:collapse'><tbody>";m+="<tr><td>Total Entries: "+s.length+"</td></tr>",s.length>0?s.forEach((e=>{m+="<tr><td class='smText' style='padding:50px;max-width:350'>"+e.img+"<br>"+e.animalId+"<br>"+e.details+"<br>"+e.intakeDate+"<br>"+e.location+"</td></tr>"})):(m+="<tr><td>No results found",""!==t&&(m+=" for "+t),m+="</td></tr>"),m+="</tbody></table>",document.write(m);var d=document.createElement("style");d.innerHTML="td {padding: 50px; font-size: 1.5em}",document.head.appendChild(d),(d=document.createElement("style")).type="text/css",d.innerHTML=".smText {font-family:Arial;font-size: 10pt; color:#0000FF; text-align: center}",document.head.appendChild(d),document.close()}}}else window.open("http://petharbor.com/detail.asp","_blank")}}();
